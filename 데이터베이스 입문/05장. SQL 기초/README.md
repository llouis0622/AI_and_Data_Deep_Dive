# 05장. SQL 기초

# 1. SQL 개요

- SQL(Structured Query Language) : 관계형 데이터베이스 표준 언어
- 질의어(Query Language) : 단순 질의, 검색 기능을 위한 언어, 데이터베이스 언어 전체
- 대화 방식(Interactive) : DBMS 온라인 인터페이스를 통해 SQL을 입력하고 그 결과를 바로 확인
- 내장 방식(Embedded) : 프로그래밍 언어로 작성된 응용 프로그램 안에 SQL을 문자열 형태로 포함

# 2. SQL 실습 준비

## 1. MySQL

- 처리 속도 빠름
- 설치 쉬움
- 대용량 데이터 처리 가능
- MySQL Workbench : MySQL에 접속하기 위한 GUI 방식의 클라이언트 응용 프로그램
- 한 줄 주석 : `--, #`
- 여러 줄 주석 : `/* ~ */`
- 대소문자 비구별
- 명령문 구분자 : `;`

# 3. SQL 데이터 조작문

## 1. 데이터 검색 SELECT문

### 1. 행 검색

- SELECT문의 형식 : SELECT절 ~ FROM절

    ```sql
    SELECT [DISTINCT|ALL] 열_리스트
    FROM 테이블_리스트
    [WHERE 검색_조건식]
    [GROUP BY 그룹_기준열_리스트]
    [HAVING 그룹_조건식]
    [ORDER BY {정렬_기준열 [ASC|DESC][,]}+];
    ```

- 테이블의 특정 열 검색

    ```sql
    SELECT 열_리스트
    FROM 테이블_리스트;
    ```

- 테이블의 모든 열 검색

    ```sql
    SELECT *
    FROM 테이블_리스트;
    ```


### 2. 중복 행을 제거하고 검색 : DISTINCT

- 중복 행을 제거하고 한 번씩만 검색 결과에 포함
- 열 개수와 상관없이 오직 한 번만 명세 가능

    ```sql
    SELECT DISTINCT 열_리스트
    FROM 테이블_리스트;
    ```


### 3. 조건 검색 : WHERE

- 조건을 만족하는 일부 행만 검색

    ```sql
    SELECT 열_리스트
    FROM 테이블_리스트
    WHERE 검색_조건식;
    ```


### 4. 순서화 검색 : ORDER BY

- 검색 결과를 반환받을 때 행들을 원하는 순서로 정렬 가능
- ASC(오름차순), DESC(내림차순)

    ```sql
    SELECT [DISTINCT|ALL] 열_리스트
    FROM 테이블_리스트
    [ORDER BY {정렬_기준열 [ASC|DESC][,]}+];
    ```


### 5. 검색 결과 제한 : LIMIT

- 전체 데이터가 아닌 상단 데이터만 검색

    ```sql
    SELECT [DISTINCT|ALL] 열_리스트
    FROM 테이블_리스트
    LIMIT 행_개수;
    ```


### 6. 집계 함수 검색 : COUNT(), MAX(), MIN(), SUM(), AVG()

- 집계 함수(Aggregate Function) : 각 열에 대한 기본 통계 결과 반환
- `COUNT(열_이름)` : 특정 열 값의 개수 또는 행의 개수
- `MAX(열_이름)` : 특정 열 값 중에서 최댓값
- `MIN(열_이름)` : 특정 열 값 중에서 최솟값
- `SUM(열_이름)` : 특정 열 값의 합계
- `AVG(열_이름)` : 특정 열 값의 평균
- `AS` : 별칭 이름, 검색 결과 반환되는 열에 대한 별칭 정의

### 7. 그룹화 검색 : GROUP BY

- 특정 열의 값이 같은 행들끼리 그룹 제작
- 개별 행이 아닌 그룹별로 검색 결과 반환

    ```sql
    SELECT [DISTINCT|ALL] 열_리스트
    FROM 테이블_리스트
    [GROUP BY 그룹_기준열_리스트]
    [HAVING 그룹_조건식]
    ```


### 8. 그룹 조건 검색 : HAVING

- 그룹이 만족해야 하는 제한 조건 명세
- GROUP BY절을 통해 생성된 그룹 중에서도 특정 조건을 만족하는 그룹만으로 검색 제한

### 9. LIKE 문자 연산자 검색 : _, % 와일드카드

- `LIKE` : 부분 문자열 포함 여부를 검색하기 위해 WHERE절에 사용
    - `_` : 문자열 중 특정 위치에 1개의 모든 문자 허용
    - `%` : 문자열 중 임의 위치에 0개 이상의 모든 문자(열) 허용

### 10. 널 값 검색 : IS NULL, IS NOT NULL

- `IS NULL` : 열의 값이 널 값인지 비교
- `IS NOT NULL` : 널 값이 아닌지 비교

### 11. 집합 연산자를 이용한 검색 : UNION

- 여러 SELECT 명령문의 검색 결과 결합
- 자동으로 중복 행을 제거한 나머지 행 반환

### 12. 서브 질의문을 이용한 검색

- 서브 질의문(Subquery) : 질의문 안에 중첩되어 포함된 또 다른 SELECT 검색문
- 괄호 안의 가장 안쪽 서브 질의문부터 가장 바깥쪽 주 질의문 순으로 수행
- IN 연산자 : 괄호 안에 나열된 값들 중에서 하나라도 일치하는 경우 참을 반환
- 내부 질의(Inner Query) : 안쪽에 위치한 서브 질의문
- 외부 질의(Outer Query) : 바깥쪽 주 질의문, 주 질의(Main Query)
- 중첩 서브 질의문
- EXISTS 연산자 : 서브 질의문의 실행 결과로 반환되는 행이 존재하는지 존재 유무 확인
- 서브 질의문 반환값 비교 연산자
    - `=, <>, ≥ , ≤, >, <` : 서브 질의문 결과가 하나이고 비교 결과가 참이면 검색 조건 만족
    - `= ALL` : 서브 질의문 결과 중 전부의 비교 결과가 참이면 검색 조건 만족
    - `= ANY, = SOME` : 서브 질의문 결과 중 하나라도 비교 결과가 참이면 검색 조건 만족
    - `IN` : 서브 질의문 결과 중 하나라도 일치하면 검색 조건 만족
    - `NOT IN` : 서브 질의문 결과 중 전부가 일치하지 않으면 검색 조건 만족
    - `EXISTS` : 서브 질의문 결과가 하나라도 존재하지 않으면 검색 조건 만족
    - `NOT EXISTS` : 서브 질의문 결과가 하나라도 존재하지 않으면 검색 조건 만족
- 스칼라 서브 질의문 : SELECT 서브 질의문
- 인라인 뷰 : FROM 서브 질의문
- 중첩 질의문 : WHERE 서브 질의문

### 13. 조인 검색 : JOIN

- 둘 이상의 테이블로부터 연관된 행들의 결합을 통해서 검색 결과 생성

    ```sql
    SELECT 열_리스트
    FROM 조인테이블_리스트
    WHERE <조인_조건식> AND <검색_조건식>;
    
    SELECT 열_리스트
    FROM 테이블이름1 {[INNER] JOIN 테이블이름2 ON <조인_조건식>}+
    WHERE <검색_조건식>;
    ```

- 크로스 조인(Cross Join) : 조인_조건식 없이 이루어진 조인, 카티션 프로덕트 연산을 적용한 결과 반환
- 동등 조인(Equi Join) : 조인_조건식에 `=` 연산자를 사용하는 동등 조건에 의한 조인
- 셀프 조인(Self Join) : 특정 테이블에 속하는 행들을 같은 테이블에 속하는 행들과 조인하는 것
- 외부 조인(Outer Join) : 조인 대상 테이블의 모든 행들이 결과에 포함
    - `LEFT OUTER JOIN` : 왼쪽 테이블의 모든 행이 조인 결과에 포함
    - `RIGHT OUTER JOIN` : 오른쪽 테이블의 모든 행이 조인 결과에 포함
    - `FULL OUTER JOIN` : 왼쪽과 오른쪽 테이블의 모든 행이 조인 결과에 포함

## 2. 행 삽인 INSERT문

- 테이블 안에 행 삽입

    ```sql
    INSERT INTO 테이블_이름 [(열_리스트)]
    VALUES (열_값_리스트);
    ```

- 행 기본 입력
    - 열 값 문자 : 작은따옴표로 둘러쌈
    - 숫자 : 작은따옴표 없이 값 나열
- 기본 값 혹은 널 값 입력
    - 기본 값 입력 : 해당 열 순서에 `DEFAULT` 명세/값 생략
    - 널 값 입력 : 해당 열 순서에 `NULL` 명세/값 생략

## 3. 행 수정 UPDATE문

- 테이블 안의 특정 행 수정

    ```sql
    UPDATE 테이블_이름
    SET 열_이름 = 산술식 [{, 열_이름=산술식}*]
    [WHERE 수정_조건식];
    ```

- 기본키와 외래키에 해당하는 열 → 참조 무결성 제약 조건을 위배하지 않는 범주 안에서 수정 가능
- 단일 행, 단일 열 수정 가능
- 복수 행, 복수 열 수정 가능
- 서브 질의문을 이용한 수정 가능

## 4. 행 삭제 DELETE문

- 테이블 안에 특정 행 삭제

    ```sql
    DELETE FROM 테이블_이름
    [WHERE 삭제_조건식];
    ```

- 단일 행, 단일 열 수정 가능
- 복수 행, 복수 열 수정 가능
- 서브 질의문을 이용한 수정 가능
- 모든 행 삭제 : 빈 테이블로 존재
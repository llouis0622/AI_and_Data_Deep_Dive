# 1. 작업 정의

## 1. 문제 정의

- 입력 데이터는 무엇인가, 예측하려는 것이 무엇인가
- 당면한 문제가 어떤 종류인가
    - 사진 검색 엔진 프로젝트 → 이진 분류 작업
    - 음악 추천 엔진 → 행렬 분해(Matrix Factorization)
    - 신용 카드 부정 거래 감지 프로젝트 → 이진 분류 작업
    - 클릭률 예측 프로젝트 → 스칼라 회귀 작업
    - 불량 쿠키 감지 → 이진 분류 작업
    - 위성 이미지 → 이미지 유사도 순위 작업
- 기존 솔루션은 어떤 것이 존재하는가
- 고려해야 할 특별한 제약이 있는가

## 2. 데이터 수집

- 작업 특성 이해, 입력, 타깃 확인 → 데이터 수집
- 가장 힘들고 시간이 많이 걸리며 비용이 많이 드는 단계
- 데이터 어노테이션 인프라 투자
    - 직접 데이터 어노테이션을 수행하는가
    - 레이블을 모으기 위해 크라우드소싱 플랫폼을 사용해야 하는가
    - 전문적인 데이터 레이블링 회사 서비스를 사용해야 하는가
    - 데이터 레이블을 할당할 사람이 해당 분야 전문가여야 하는가
    - 전문적인 지식을 훈련할 수 있는가
    - 전문가의 어노테이션 작업을 개발자가 이해하고 있는가
- 대표성 없는 데이터 주의

## 3. 데이터 이해

- 이미지나 자연어 텍스트 → 몇 개의 샘플 직접 확인
- 수치 특성 → 특성 값의 히스토그램으로 값의 범위나 빈도 파악
- 위치 정보 포함 → 지도에 표현
- 어떤 특성에 대해 누락된 값 존재 → 데이터 준비 시 처리
- 분류 문제 → 각 클래스의 샘플 개수 출력
- 타깃 누출(Target Leaking) 확인

## 4. 성공 지표 선택

- 클래스 분포 균일한 분류 문제 → 정확도, ROC AUC
- 클래스 분포 균일하지 않은 문제, 랭킹 문제, 다중 레이블 문제 → 정밀도, 재현율

# 2. 모델 개발

## 1. 데이터 준비

- 데이터 벡터화(Data Vectorization) : 사운드, 이미지, 텍스트 → 텐서로 변환
- 값 정규화
    - 작은 값을 취함 → 일반적으로 대부분의 값이 0 ~ 1 사이
    - 균일 : 모든 특성이 대체로 비슷한 범위
    - 각 특성별 평균이 0이 되도록 정규화
    - 각 특성별 표준 편차가 1이 되도록 정규화
- 누락된 값 처리
    - 범주형 특성 → 누락된 값의 새로운 범주 생성
    - 수치형 특성 → 0 같은 임의의 값 주입 금지

## 2. 평가 방법 선택

- 홀드아웃 검증 : 데이터가 풍부할 때 사용
- K-Fold 교차 검증 : 샘플 개수가 너무 적을 때 사용
- 반복 K-Fold 교차 검증 : 데이터가 적고 매우 정확한 모델 평가가 필요할 때 사용

## 3. 기준 모델 뛰어넘기

- 통계적 검정력(Statistical Power) : 아주 간단한 기준점을 넘을 수 있는 작은 모델 개발
    - 특성 공학 : 유용하지 않은 특성 제외, 문제에 대한 지식 사용 → 새 특성 개발
    - 구조에 대한 올바른 가정 : 모델 구조 종류 선택
    - 좋은 훈련 옵션 선택 : 손실 함수, 배치 크기, 학습률

## 4. 모델 용량 키우기 : 과대적합 모델 만들기

- 층 추가
- 층 크기 증가
- 더 많은 에포크로 훈련

## 5. 모델 규제와 하이퍼파라미터 튜닝

- 반복적으로 모델 수정 및 훈련 → 검증 데이터에서 평가
- 다른 구조 시도, 층 추가 및 제거
- 드롭아웃 추가
- L1, L2 규제 추가
- 하이퍼파라미터 수정
- 데이터 큐레이션, 특성 공학 시도

# 3. 모델 배포

## 1. 고객에게 작업을 설명하고 기대치 설정하기

- 거짓 음성 비율과 거짓 양성 비율로 설명
- 적용할 핵심적인 파라미터 논의

## 2. 추론 모델 배치하기

- 파이썬이 아닌 다른 방식으로 모델 저장
    - 모바일 앱, 임베디드 시스템 등
    - 파이썬으로 작성되지 않음
- 제품 모델 → 훈련이 아닌 예측을 위해서만 사용
- REST API로 모델 배포하기
    - 서버, 클라우드 인스턴스 → 텐서플로 설치, REST API 모델 예측 요청
    - 플라스크 → 직접 서빙 앱 제작 가능
    - 텐서플로 자체 라이브러리 → 텐서플로 서빙
    - 인터넷에 안정적으로 접속 가능
    - 응답 속도에 대한 요구사항이 엄격하지 않음
    - 추론을 위해 전달되는 입력 데이터가 크게 민감하지 않음
- 장치로 모델 배포하기
    - 모델 응답 속도 제약이 엄격함
    - 인터넷 연결이 불안정한 환경에서 실행
    - 모델을 충분히 작게 만들 수 있음
    - 가장 높은 정확도를 달성하는 것이 작업에서 크게 중요하지 않음
    - 입력 데이터에 매우 민감한 정보가 포함되어 있음
- 브라우저에 모델 배포하기
    - 사용자 측에서 계산 수행 → 서버 비용 감소 가능
    - 입력 데이터가 사용자의 컴퓨터, 핸드폰에 존재
    - 애플리케이션 응답 속도 제약 엄격함
    - 인터넷이 연결되지 않은 상태에서 작동하는 앱 필요
- 추론 모델 최적화
    - 가중치 가지치기(Weight Pruning) : 가중치 텐서의 모든 값이 예측에 동일하게 기여하지 않음
    - 가중치 양자화(Weight Quantization) : 8비트의 부호 있는 정수로 압축 가능

## 3. 작동 중 모델 모니터링

- 랜덤한 A/B 테스트 → 모델 영향과 다른 변경 사항 격리
- 제품 환경에서 모델 예측 정기적으로 수동 조사
- 수동 조사 불가능 → 다른 평가 수단 고려

## 4. 모델 유지 관리

- 제품 환경의 데이터에 대한 변화 감시
- 꾸준한 데이터 수집 및 어노테이션 수행
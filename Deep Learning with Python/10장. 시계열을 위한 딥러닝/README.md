# 1. 다양한 종류의 시계열 작업

- 시계열 데이터(Timeseries) : 일정한 간격으로 측정하여 얻은 모든 데이터
- 예측(Forecasting) : 현시점의 시계열 데이터 다음에 일어날 것을 예측
- 분류 : 하나 이상의 범주형 레이블을 시계열에 부여
- 이벤트 감지 : 연속된 데이터 스트림에서 예상되는 특정 이벤트 발생 식별
- 이상치 탐지(Anomaly Detection) : 연속된 데이터 스트림에서 발생하는 비정상적인 현상 감지
- 푸리에 변환(Fourier Transform) : 시계열 값을 여러 다른 주파수 성분으로 분리, 주기와 진동이 특징인 데이터에 유용

# 2. 온도 예측 문제

- 여러 시간 범위에 걸친 주기성 → 시계열 데이터에서 중요하고 매우 일반적인 성질
- 검증 데이터와 테스트 데이터는 훈련 데이터보다 최신이어야 함

## 1. 데이터 준비

- `timeseries_dataset_from_array()` : 원본 시계열에서 추출한 윈도우 제공
    - `sampling_rate` : 시간당 하나의 데이터 포인트 샘플링
    - `sequence_length` : 이전 시간 길이 데이터
    - `delay` : 일정 범위

## 2. 상식 수준의 기준점

- 기본적인 기준점 설정
- 기본적인 기준점을 넘어서기 어려움 → 연속성, 주기성 보유

## 3. 기본적인 머신러닝 모델 시도

- 연산 비용이 많이 드는 모델 이전 소규모 네트워크로 시도
- 특정 종류의 간단한 모델을 찾도록 학습 알고리즘 하드코딩 되지 않음 → 간단한 문제를 위한 간략한 해결책을 찾기 못함

## 4. 1D 합성곱 모델 시도

- 입력 시퀀스 일별 주기 → 합성곱 모델 적용 가능
- 시간 축에 대한 합성곱 → 다른 날 동일한 표현 재사용 가능

## 5. 첫 번째 순환 신경망

- 순환 신경망 : 인과 관계와 순서가 의미 있는 시퀀스 데이터를 그대로 사용
- LSTM(Long Short-Term Memory)

# 3. 순환 신경망(RNN, Recurrent Neural Network)

- 시계열 데이터 처리 → 전체 시퀀스를 하나의 데이터 포인트로 변환 필요
- 피드포워드 네트워크(FeedForward Network) : 데이터를 펼쳐 하나의 큰 벡터로 만들어 처리
- 시퀀스의 원소를 순회하면서 지금까지 처리한 정보를 상태에 저장
- 2개의 다른 시퀀스를 처리하는 사이에 재설정 → 하나의 시퀀스를 하나의 데이터 포인트로 간주
- 반복할 때 이전에 계산한 정볼르 재사용하는 for 루프와 비슷 → 스텝 함수에 특화

## 1. 케라스의 순환층

- `SimpleRNN` : 시퀀스의 배치 처리
- 케라스의 모든 순환 층(SimpleRNN, LSTM, GRU) → 두 가지 모드 실행
    - 각 타임스템의 출력을 모은 전체 시퀀스 크기의 랭크-3 텐서 반환
    - 입력 시퀀스의 마지막 출력 크기의 랭크-2 텐서 반환
- 긴 시간에 걸친 의존성 학습 불가 → 그레이디언트 소실 문제 발생
- LSTM : 장-단기 메모리 알고리즘
    - 정보를 여러 타임스텝에 걸쳐 나르는 방법 추가
    - 나중을 위해 정보 저장 → 처리 과정에서 오래된 시그널 소실 방지
    - 이동을 위한 데이터 흐름 → 관련이 적은 정보 의도적 삭제
    - 현재에 대한 정보 제공, 이동 트랙 새로운 정보로 업데이트

# 4. 순환 신경망의 고급 사용법

## 1. 과대적합을 감소하기 위해 순환 드롭아웃 사용하기

- 동일한 드롭아웃 마스크를 모든 타임스텝에 적용
- 네트워크 → 학습 오차를 타임스텝에 걸쳐 적절하게 전파 가능

## 2. 스태킹 순환층

- 네트워크 용량 & 표현력 늘리기 → 과대적합이 일어날 때까지 모델 용량 증가
- 층에 있는 유닛 개수 증가, 층 추가

## 3. 양방향 RNN(Bidirectional RNN) 사용하기

- 각 RNN → 입력 시퀀스를 한 방향으로 처리한 후 각 표현을 합침
- 시퀀스 양쪽 방향으로 처리 → 놓치기 쉬운 패턴 감지
- 시간 순서대로 처리 > 거꾸로 처리
- 앙상블 개념 → 데이터를 바라보는 새로운 시각 제공 + 다른 방식에서 놓칠 수 있는 데이터 특징 잡아냄

## 4. 추가 시도

- 스태킹 → 각 순환층의 유닛 개수, 드롭아웃 양 조정
- RMSprop 옵티마이저 학습률 조정, 다른 옵티마이저 사용
- 순환층 위에 놓을 회귀 모델 → 여러 개의 Dense 층
- 모델 입력 개선 → 더 길거나 짧은 시퀀스, 샘플링 간격 조정, 특성 공학